---
import Section from "@/components/ui/Section.astro";
import { CONTACT } from "@/utils/contact";

interface Props {
  id?: string;
  title?: string;
  subtitle?: string;
  eyebrow?: string | null;
  trust?: string[];
  ctaLabel?: string;
  ctaHref?: string;
  secondaryCta?: { label: string; href: string } | null;
  variant?: "default" | "inverted";
  flushWithFooter?: boolean;
  className?: string;
}

const {
  id = "cta",
  title = "¿Listo para lanzar tu landing con Landqo?",
  subtitle = "Implementación única + hosting gestionado. Publicamos en subdominio Velcodi o en tu dominio propio.",
  eyebrow = null,
  trust = [],
  ctaLabel = "Hablar ahora",
  ctaHref = "#contacto",
  secondaryCta = null,
  variant = "inverted",
  flushWithFooter = true,
  className = "",
} = Astro.props as Props;

// Enlaza a WhatsApp (target _blank) con fallback al ctaHref
const primaryLink = CONTACT.ctaLink({
  intent: "ventas",
  source: "cta-final",
  fallback: ctaHref,
});
---

<Section
  id={id}
  title={title}
  subtitle={subtitle}
  variant={variant}
  className={`${flushWithFooter ? "pt-8 pb-0" : ""} ${className}`}
  titleAccent="underline"
  subtitleMuted
>
  <div class="container">
    <div class="mx-auto max-w-3xl text-center">
      {eyebrow && <p class="eyebrow">{eyebrow}</p>}

      {/* Chips de confianza */}
      {
        Array.isArray(trust) && trust.length > 0 && (
          <ul class="trust" role="list">
            {trust.map((t) => (
              <li class="chip">{t}</li>
            ))}
          </ul>
        )
      }

      <div class="actions">
        <a
          href={primaryLink.href}
          class="btn btn-primary btn-lg rounded-2xl px-5"
          {...primaryLink.target
            ? { target: primaryLink.target, rel: primaryLink.rel }
            : {}}
        >
          {ctaLabel}
        </a>
        {
          secondaryCta && (
            <a
              href={secondaryCta.href}
              class="btn btn-outline btn-lg rounded-2xl px-5"
            >
              {secondaryCta.label}
            </a>
          )
        }
      </div>
    </div>
  </div>
</Section>

<style is:inline>
  .eyebrow {
    display: inline-block;
    margin-bottom: 0.75rem;
    padding: 0.28rem 0.6rem;
    font-size: 0.78rem;
    font-weight: 800;
    letter-spacing: 0.06em;
    text-transform: uppercase;
    color: color-mix(in oklch, var(--color-primary) 95%, var(--color-fg));
    background: color-mix(in oklch, var(--color-primary) 14%, var(--color-bg));
    border-radius: 999px;
    box-shadow: inset 0 0 0 1px
      color-mix(in oklch, var(--color-primary) 42%, var(--color-border));
  }
  .trust {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem 0.6rem;
    justify-content: center;
    margin: 0.75rem 0 1.25rem;
  }
  .chip {
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    padding: 0.35rem 0.65rem;
    border-radius: 999px;
    font-weight: 700;
    font-size: 0.78rem;
    background: var(--color-bg-elev);
    color: var(--color-fg);
    box-shadow: inset 0 0 0 1px var(--color-border);
  }
  .actions {
    display: flex;
    gap: 0.6rem;
    justify-content: center;
    margin-top: 0.6rem;
    flex-wrap: wrap;
  }
</style>
